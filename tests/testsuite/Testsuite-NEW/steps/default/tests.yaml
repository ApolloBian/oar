tests:
  - load_libs:
    - exec_appliance: write_irb "require '/home/kameleon/lib/librspectests'" 
  - create_objects:
    - exec_appliance: write_irb "obj = Tests.new" 
  - test_get_version:
    - exec_appliance: write_irb "obj.test_get_version" 
  - test_get_timezone:
    - exec_appliance: write_irb "obj.test_get_timezone" 
  - test_submit_job:                
    - exec_appliance: write_irb "jhash = { 'resource' => \"/nodes=1/core=1\" , 'script' => \"ls;pwd;whoami\" }" 
    - exec_appliance: write_irb "obj.test_submit_job(jhash)" 
  - test_get_jobs_detail:                    
    - exec_appliance: write_irb "obj.test_get_jobs_details" 
  - test_get_running_jobs:
    - exec_appliance: write_irb "obj.test_get_running_jobs"
  - test_job_dump_table:
    - exec_appliance: write_irb "obj.test_get_jobs_table" 
  - test_get_resource_state:
    - exec_appliance: write_irb "obj.test_get_resources" 
  - test_get_resource_details:
    - exec_appliance: write_irb "obj.test_get_resources_full" 
  - print_output:
    - exec_appliance: write_irb "exit"
    - exec_appliance: sleep 1
    - exec_appliance: cat irb_stdout|tee output_file
    - exec_appliance: echo "Results of the Testsuite Run"
    - exec_appliance: sleep 4
    - exec_appliance: grep -C 1 "OarApis" output_file
    - exec_appliance: sleep 3
    - exec_appliance: grep failures output_file>numexamples
    - exec_appliance: sleep 3
    - exec_appliance: cat numexamples|wc -l|sed 's/^/Total Number of examples run:/'
    - exec_appliance: sleep 3
    - exec_appliance: awk -F '[ ,]' '{static s; if($4 == 0) s++}; END { print s }' numexamples|sed 's/^/Number of Successes:/'
    - exec_appliance: echo "Time taken to run each tests"
    - exec_appliance: sleep 2
    - exec_appliance: grep seconds output_file|tee testtime
    - exec_appliance: echo "Total Time taken:"
    - exec_appliance: awk '{ static timesum; timesum+=$3 }; END { print timesum }' testtime
