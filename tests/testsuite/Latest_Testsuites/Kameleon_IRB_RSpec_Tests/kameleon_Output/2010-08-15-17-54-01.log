[32m[1m  | Loading /var/lib/kameleon/steps/default/irb.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/load_lib_create_object.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/scenario2.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/print_output.yaml[0m
[34m[1m
 ### [0m[32m[1mWelcome to Kameleon 1.2.1[0m[34m[1m ###
[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mcreate_pipes[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; mkfifo irb_stdout[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; mkfifo irb_stdin[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; mkfifo irb_stderr[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mstart[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; irb <irb_stdin >irb_stdout &[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; IRB_PID=$![0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mbash_function[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; function write_irb(){ echo "$1" > irb_stdin; }[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mclean[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; echo "kill $IRB_PID" >> /var/tmp/kameleon/2010-08-15-17-54-01/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-17-54-01/chroot/irb_stdout" >> /var/tmp/kameleon/2010-08-15-17-54-01/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-17-54-01/chroot/irb_stdin" >> /var/tmp/kameleon/2010-08-15-17-54-01/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-17-54-01/chroot/irb_stderr" >> /var/tmp/kameleon/2010-08-15-17-54-01/clean.sh[0m
[36m->[0m[32m[1m| Executing load_lib_create_object[0m[36m->[0m[32m[1mload_libs[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "require '/home/kameleon/lib/rspectests_lib.rb'"[0m
[36m->[0m[32m[1m| Executing load_lib_create_object[0m[36m->[0m[32m[1mcreate_objects[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "obj = Tests.new(\"http://kameleon:kameleon@localhost/oarapi-priv\")"[0m
[36m->[0m[32m[1m| Executing scenario2[0m[36m->[0m[32m[1msubmit_job[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "puts \"Submitting a job that runs for 2mnts\""[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "jhash = { 'resource' => \"/nodes=1/core=1\" , 'script' => \"ls;pwd;whoami;sleep 120\" }"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "obj.test_submit_job(jhash)"[0m
[36m->[0m[32m[1m| Executing scenario2[0m[36m->[0m[32m[1mtest_if_submitted[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "jid = obj.jobid"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "puts \"Submitted job \"+jid.to_s"[0m
[36m->[0m[32m[1m| Executing scenario2[0m[36m->[0m[32m[1mtest_if_job_running[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "puts \"Test if job is running after 1mnt\""[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "sleep 65"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "obj.test_job_running(jid)"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "puts \"Scenario2 successfully tested! \""[0m
[36m->[0m[32m[1m| Executing print_output[0m[36m->[0m[32m[1mprint[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; write_irb "exit"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; sleep 1[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; cat irb_stdout|tee output_file[0m
require '/home/kameleon/lib/rspectests_lib.rb'
true
obj = Tests.new("http://kameleon:kameleon@localhost/oarapi-priv")
#<Tests:0xb6f19b98 @obj=#<OarApi:0xb6f19b70 @apiuri="http://kameleon:kameleon@localhost/oarapi-priv", @api=#<RestClient::Resource:0xb6f19b48 @block=nil, @url="http://kameleon:kameleon@localhost/oarapi-priv", @options={}>>>
puts "Submitting a job that runs for 2mnts"
Submitting a job that runs for 2mnts
nil
jhash = { 'resource' => "/nodes=1/core=1" , 'script' => "ls;pwd;whoami;sleep 120" }
{"script"=>"ls;pwd;whoami;sleep 120", "resource"=>"/nodes=1/core=1"}
obj.test_submit_job(jhash)
Job ID: =>80

OarApi
- should check the correct functioning of POST /jobs API

Finished in 0.671383 seconds

1 example, 0 failures
true
jid = obj.jobid
"80"
puts "Submitted job "+jid.to_s
Submitted job 80
nil
puts "Test if job is running after 1mnt"
Test if job is running after 1mnt
nil
sleep 65
65
obj.test_job_running(jid)

OarApi
- should check if job is still running

Finished in 0.520257 seconds

1 example, 0 failures
true
puts "Scenario2 successfully tested! "
Scenario2 successfully tested! 
nil
exit
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; echo "Results of the Testsuite Run"[0m
Results of the Testsuite Run
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; sleep 4[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; grep -C 1 "OarApi" output_file[0m
obj = Tests.new("http://kameleon:kameleon@localhost/oarapi-priv")
#<Tests:0xb6f19b98 @obj=#<OarApi:0xb6f19b70 @apiuri="http://kameleon:kameleon@localhost/oarapi-priv", @api=#<RestClient::Resource:0xb6f19b48 @block=nil, @url="http://kameleon:kameleon@localhost/oarapi-priv", @options={}>>>
puts "Submitting a job that runs for 2mnts"
--

OarApi
- should check the correct functioning of POST /jobs API
--

OarApi
- should check if job is still running
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; grep failure output_file>numexamples[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; cat numexamples|wc -l|sed 's/^/Total Number of examples run:/'[0m
Total Number of examples run:2
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; awk -F '[ ,]' '{static s; if($4 == 0) s++}; END { print s }' numexamples|sed 's/^/Number of Successes:/'[0m
Number of Successes:2
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; echo "Time taken to run each tests"[0m
Time taken to run each tests
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; sleep 2[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; grep seconds output_file|tee testtime[0m
Finished in 0.671383 seconds
Finished in 0.520257 seconds
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; echo "Total Time taken:"[0m
Total Time taken:
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-54-01/chroot; awk '{ static timesum; timesum+=$3 }; END { print timesum }' testtime[0m
1.19164
