[32m[1m  | Loading /var/lib/kameleon/steps/default/irb.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/load_lib_create_object.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/unit_tests.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/scenario1.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/print_output.yaml[0m
[34m[1m
 ### [0m[32m[1mWelcome to Kameleon 1.2.1[0m[34m[1m ###
[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mcreate_pipes[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; mkfifo irb_stdout[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; mkfifo irb_stdin[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; mkfifo irb_stderr[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mstart[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; irb <irb_stdin >irb_stdout &[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; IRB_PID=$![0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mbash_function[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; function write_irb(){ echo "$1" > irb_stdin; }[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mclean[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; echo "kill $IRB_PID" >> /var/tmp/kameleon/2010-08-15-17-34-32/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-17-34-32/chroot/irb_stdout" >> /var/tmp/kameleon/2010-08-15-17-34-32/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-17-34-32/chroot/irb_stdin" >> /var/tmp/kameleon/2010-08-15-17-34-32/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-17-34-32/chroot/irb_stderr" >> /var/tmp/kameleon/2010-08-15-17-34-32/clean.sh[0m
[36m->[0m[32m[1m| Executing load_lib_create_object[0m[36m->[0m[32m[1mload_libs[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "require '/home/kameleon/lib/rspectests_lib.rb'"[0m
[36m->[0m[32m[1m| Executing load_lib_create_object[0m[36m->[0m[32m[1mcreate_objects[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj = Tests.new(\"http://kameleon:kameleon@localhost/oarapi-priv\")"[0m
[36m->[0m[32m[1m| Executing unit_tests[0m[36m->[0m[32m[1mtest_get_version[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_get_version"[0m
[36m->[0m[32m[1m| Executing unit_tests[0m[36m->[0m[32m[1mtest_get_timezone[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_get_timezone"[0m
[36m->[0m[32m[1m| Executing unit_tests[0m[36m->[0m[32m[1mtest_submit_job[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "jhash = { 'resource' => \"/nodes=1/core=1\" , 'script' => \"ls;pwd;whoami\" }"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_submit_job(jhash)"[0m
[36m->[0m[32m[1m| Executing unit_tests[0m[36m->[0m[32m[1mtest_get_jobs_detail[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_get_jobs_details"[0m
[36m->[0m[32m[1m| Executing unit_tests[0m[36m->[0m[32m[1mtest_get_running_jobs[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_get_running_jobs"[0m
[36m->[0m[32m[1m| Executing unit_tests[0m[36m->[0m[32m[1mtest_job_dump_table[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_get_jobs_table"[0m
[36m->[0m[32m[1m| Executing unit_tests[0m[36m->[0m[32m[1mtest_get_resource_state[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_get_resources"[0m
[36m->[0m[32m[1m| Executing unit_tests[0m[36m->[0m[32m[1mtest_get_resource_details[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_get_resources_full"[0m
[36m->[0m[32m[1m| Executing scenario1[0m[36m->[0m[32m[1msubmit_job[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "jhash = { 'resource' => \"/nodes=1/core=1\" , 'script' => \"ls;pwd;whoami;sleep 60\" }"[0m
[36m->[0m[32m[1m| Executing scenario1[0m[36m->[0m[32m[1mtest_if_submitted[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_submit_job(jhash)"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "jid = obj.jobid"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "puts \"Submitted job \"+jid.to_s"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_job_in_queue(jid)"[0m
[36m->[0m[32m[1m| Executing scenario1[0m[36m->[0m[32m[1mdelete_job[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "puts \"Deleting job \"+jid.to_s"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "puts jid.to_s"[0m
[36m->[0m[32m[1m| Executing scenario1[0m[36m->[0m[32m[1mtest_if_deleted[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_jobs_delete(jid)"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "obj.test_job_notin_queue(jid)"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "puts \"Scenario1 successfully tested!\""[0m
[36m->[0m[32m[1m| Executing print_output[0m[36m->[0m[32m[1mprint[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; write_irb "exit"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; sleep 1[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; cat irb_stdout|tee output_file[0m
require '/home/kameleon/lib/rspectests_lib.rb'
true
obj = Tests.new("http://kameleon:kameleon@localhost/oarapi-priv")
#<Tests:0xb6f92304 @obj=#<OarApi:0xb6f922dc @apiuri="http://kameleon:kameleon@localhost/oarapi-priv", @api=#<RestClient::Resource:0xb6f922b4 @block=nil, @url="http://kameleon:kameleon@localhost/oarapi-priv", @options={}>>>
obj.test_get_version

OarApi
- should return the OAR Version Details Successfully through GET /version REST API

Finished in 0.336411 seconds

1 example, 0 failures
true
obj.test_get_timezone

OarApi
- should return the correct OAR Timezone of the OAR Server

Finished in 0.311811 seconds

1 example, 0 failures
true
jhash = { 'resource' => "/nodes=1/core=1" , 'script' => "ls;pwd;whoami" }
{"script"=>"ls;pwd;whoami", "resource"=>"/nodes=1/core=1"}
obj.test_submit_job(jhash)
Job ID: =>78

OarApi
- should check the correct functioning of POST /jobs API

Finished in 0.718149 seconds

1 example, 0 failures
true
obj.test_get_jobs_details

OarApi
- should check the correct functioning of GET /job/details API

Finished in 0.511212 seconds

1 example, 0 failures
true
obj.test_get_running_jobs

OarApi
- should check the correct functioning of GET /jobs API

Finished in 0.665777 seconds

1 example, 0 failures
true
obj.test_get_jobs_table

OarApi
- should check the correct functioning of GET /jobs/table API

Finished in 0.779812 seconds

1 example, 0 failures
true
obj.test_get_resources

OarApi
- should check the correct functioning of GET /resources

Finished in 0.920704 seconds

1 example, 0 failures
true
obj.test_get_resources_full

OarApi
- should check the correct functioning of GET /resources/full

Finished in 0.518349 seconds

1 example, 0 failures
true
jhash = { 'resource' => "/nodes=1/core=1" , 'script' => "ls;pwd;whoami;sleep 60" }
{"script"=>"ls;pwd;whoami;sleep 60", "resource"=>"/nodes=1/core=1"}
obj.test_submit_job(jhash)
Job ID: =>79

OarApi
- should check the correct functioning of POST /jobs API

Finished in 0.977644 seconds

1 example, 0 failures
true
jid = obj.jobid
"79"
puts "Submitted job "+jid.to_s
Submitted job 79
nil
obj.test_job_in_queue(jid)

OarApi
- should contain jobid in queue of created job

Finished in 0.868166 seconds

1 example, 0 failures
true
puts "Deleting job "+jid.to_s
Deleting job 79
nil
puts jid.to_s
79
nil
obj.test_jobs_delete(jid)

OarApi
- should check the correct functioning of DELETE /jobs/<id>

Finished in 0.852037 seconds

1 example, 0 failures
true
obj.test_job_notin_queue(jid)

OarApi
- should not contain the deleted job in the queue now (FAILED - 1)

1)
'OarApi should not contain the deleted job in the queue now' FAILED
expected not: == "1",
         got:    "1"
./tmpfile.rb:3:

Finished in 0.536633 seconds

1 example, 1 failure
true
puts "Scenario1 successfully tested!"
Scenario1 successfully tested!
nil
exit
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; echo "Results of the Testsuite Run"[0m
Results of the Testsuite Run
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; sleep 4[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; grep -C 1 "OarApi" output_file[0m
obj = Tests.new("http://kameleon:kameleon@localhost/oarapi-priv")
#<Tests:0xb6f92304 @obj=#<OarApi:0xb6f922dc @apiuri="http://kameleon:kameleon@localhost/oarapi-priv", @api=#<RestClient::Resource:0xb6f922b4 @block=nil, @url="http://kameleon:kameleon@localhost/oarapi-priv", @options={}>>>
obj.test_get_version

OarApi
- should return the OAR Version Details Successfully through GET /version REST API
--

OarApi
- should return the correct OAR Timezone of the OAR Server
--

OarApi
- should check the correct functioning of POST /jobs API
--

OarApi
- should check the correct functioning of GET /job/details API
--

OarApi
- should check the correct functioning of GET /jobs API
--

OarApi
- should check the correct functioning of GET /jobs/table API
--

OarApi
- should check the correct functioning of GET /resources
--

OarApi
- should check the correct functioning of GET /resources/full
--

OarApi
- should check the correct functioning of POST /jobs API
--

OarApi
- should contain jobid in queue of created job
--

OarApi
- should check the correct functioning of DELETE /jobs/<id>
--

OarApi
- should not contain the deleted job in the queue now (FAILED - 1)
--
1)
'OarApi should not contain the deleted job in the queue now' FAILED
expected not: == "1",
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; grep failure output_file>numexamples[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; cat numexamples|wc -l|sed 's/^/Total Number of examples run:/'[0m
Total Number of examples run:12
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; awk -F '[ ,]' '{static s; if($4 == 0) s++}; END { print s }' numexamples|sed 's/^/Number of Successes:/'[0m
Number of Successes:11
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; echo "Time taken to run each tests"[0m
Time taken to run each tests
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; sleep 2[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; grep seconds output_file|tee testtime[0m
Finished in 0.336411 seconds
Finished in 0.311811 seconds
Finished in 0.718149 seconds
Finished in 0.511212 seconds
Finished in 0.665777 seconds
Finished in 0.779812 seconds
Finished in 0.920704 seconds
Finished in 0.518349 seconds
Finished in 0.977644 seconds
Finished in 0.868166 seconds
Finished in 0.852037 seconds
Finished in 0.536633 seconds
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; echo "Total Time taken:"[0m
Total Time taken:
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-17-34-32/chroot; awk '{ static timesum; timesum+=$3 }; END { print timesum }' testtime[0m
7.9967
