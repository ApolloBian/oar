[32m[1m  | Loading /var/lib/kameleon/steps/default/irb.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/load_lib_create_object.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/scenario5.yaml[0m
[32m[1m  | Loading /var/lib/kameleon/steps/default/print_output.yaml[0m
[34m[1m
 ### [0m[32m[1mWelcome to Kameleon 1.2.1[0m[34m[1m ###
[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mcreate_pipes[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; mkfifo irb_stdout[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; mkfifo irb_stdin[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; mkfifo irb_stderr[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mstart[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; irb <irb_stdin >irb_stdout &[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; IRB_PID=$![0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mbash_function[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; function write_irb(){ echo "$1" > irb_stdin; }[0m
[36m->[0m[32m[1m| Executing irb[0m[36m->[0m[32m[1mclean[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; echo "kill $IRB_PID" >> /var/tmp/kameleon/2010-08-15-18-30-37/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-18-30-37/chroot/irb_stdout" >> /var/tmp/kameleon/2010-08-15-18-30-37/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-18-30-37/chroot/irb_stdin" >> /var/tmp/kameleon/2010-08-15-18-30-37/clean.sh[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; echo "rm -f /var/tmp/kameleon/2010-08-15-18-30-37/chroot/irb_stderr" >> /var/tmp/kameleon/2010-08-15-18-30-37/clean.sh[0m
[36m->[0m[32m[1m| Executing load_lib_create_object[0m[36m->[0m[32m[1mload_libs[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "require '/home/kameleon/lib/rspectests_lib.rb'"[0m
[36m->[0m[32m[1m| Executing load_lib_create_object[0m[36m->[0m[32m[1mcreate_objects[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "obj = Tests.new(\"http://kameleon:kameleon@localhost/oarapi-priv\")"[0m
[36m->[0m[32m[1m| Executing scenario5[0m[36m->[0m[32m[1msubmit_job[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "jhash = { 'resource' => \"/nodes=1/core=1\" , 'script' => \"ls;pwd;whoami\" }"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "obj.test_submit_job(jhash)"[0m
[36m->[0m[32m[1m| Executing scenario5[0m[36m->[0m[32m[1mtest_if_submitted[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "jid = obj.jobid"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "puts \"Submitted job \"+jid.to_s"[0m
[36m->[0m[32m[1m| Executing scenario5[0m[36m->[0m[32m[1mcheckpoint_job[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "puts \"Checkpointing job \"+jid.to_s"[0m
[36m->[0m[32m[1m| Executing scenario5[0m[36m->[0m[32m[1mtest_checkpointed_job_details[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "obj.test_job_checkpoint(jid)"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "puts \"Scenario5 successfully tested!\""[0m
[36m->[0m[32m[1m| Executing print_output[0m[36m->[0m[32m[1mprint[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; write_irb "exit"[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; sleep 1[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; cat irb_stdout|tee output_file[0m
require '/home/kameleon/lib/rspectests_lib.rb'
true
obj = Tests.new("http://kameleon:kameleon@localhost/oarapi-priv")
#<Tests:0xb7011bb8 @obj=#<OarApi:0xb7011b90 @apiuri="http://kameleon:kameleon@localhost/oarapi-priv", @api=#<RestClient::Resource:0xb7011b68 @block=nil, @url="http://kameleon:kameleon@localhost/oarapi-priv", @options={}>>>
jhash = { 'resource' => "/nodes=1/core=1" , 'script' => "ls;pwd;whoami" }
{"script"=>"ls;pwd;whoami", "resource"=>"/nodes=1/core=1"}
obj.test_submit_job(jhash)
Job ID: =>83

OarApi
- should check the correct functioning of POST /jobs API

Finished in 0.605593 seconds

1 example, 0 failures
true
jid = obj.jobid
"83"
puts "Submitted job "+jid.to_s
Submitted job 83
nil
puts "Checkpointing job "+jid.to_s
Checkpointing job 83
nil
obj.test_job_checkpoint(jid)
ERROR 400:
 {
   "title" : "Oar error",
   "message" : "Oar command exited with status 1280: Checkpointing the job 83 ...ERROR.\nCannot checkpoint 83 ; This job is not running.\n",
   "code" : 400
}

[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; echo "Results of the Testsuite Run"[0m
Results of the Testsuite Run
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; sleep 4[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; grep -C 1 "OarApi" output_file[0m
obj = Tests.new("http://kameleon:kameleon@localhost/oarapi-priv")
#<Tests:0xb7011bb8 @obj=#<OarApi:0xb7011b90 @apiuri="http://kameleon:kameleon@localhost/oarapi-priv", @api=#<RestClient::Resource:0xb7011b68 @block=nil, @url="http://kameleon:kameleon@localhost/oarapi-priv", @options={}>>>
jhash = { 'resource' => "/nodes=1/core=1" , 'script' => "ls;pwd;whoami" }
--

OarApi
- should check the correct functioning of POST /jobs API
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; grep failure output_file>numexamples[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; cat numexamples|wc -l|sed 's/^/Total Number of examples run:/'[0m
Total Number of examples run:1
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; sleep 3[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; awk -F '[ ,]' '{static s; if($4 == 0) s++}; END { print s }' numexamples|sed 's/^/Number of Successes:/'[0m
Number of Successes:1
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; echo "Time taken to run each tests"[0m
Time taken to run each tests
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; sleep 2[0m
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; grep seconds output_file|tee testtime[0m
Finished in 0.605593 seconds
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; echo "Total Time taken:"[0m
Total Time taken:
[32m[1m  |-> cd /var/tmp/kameleon/2010-08-15-18-30-37/chroot; awk '{ static timesum; timesum+=$3 }; END { print timesum }' testtime[0m
0.605593
