oar_install_from_git:

 - debian_fix_mime_support:
   - exec_chroot: apt-get -f install -y --force-yes mime-support || true
   - exec_appliance: rm -rf $$chroot/var/lib/dpkg/info/mime-support.* || true
   - exec_chroot: apt-get -f install -y --force-yes mime-support

 - rpm_fix_sudo:
   - exec_chroot: groupadd sudo || true

 - get_git_snapshot:
   - exec_chroot: mkdir -p $$oar_source_install_directory
   - exec_chroot: git init $$oar_source_install_directory
   - exec_appliance: git --git-dir $$chroot/$$oar_source_install_directory/.git --work-tree $$chroot/$$oar_source_install_directory fetch --depth 0 $$oar_git_repository $$oar_git_treeish
   - exec_appliance: git --git-dir $$chroot/$$oar_source_install_directory/.git --work-tree $$chroot/$$oar_source_install_directory checkout FETCH_HEAD

 - install_oar:
   - exec_chroot: make -C $$oar_source_install_directory build
   - exec_chroot: make -C $$oar_source_install_directory server-install user-install node-install doc-install draw-gantt-install monika-install www-conf-install api-install
   - exec_chroot: make -C $$oar_source_install_directory server-setup user-setup node-setup doc-setup draw-gantt-setup monika-setup www-conf-setup api-setup

 - debian_install_initd:
   - exec_chroot: cp /usr/local/share/doc/oar-server/examples/init.d/oar-server /etc/init.d/
   - exec_chroot: cp /usr/local/share/doc/oar-node/examples/init.d/oar-node /etc/init.d/
   - exec_chroot: cp /usr/local/share/doc/oar-server/examples/default/oar-server /etc/default/
   - exec_chroot: cp /usr/local/share/doc/oar-node/examples/default/oar-node /etc/default/
   - exec_chroot: update-rc.d oar-server defaults
   - exec_chroot: update-rc.d oar-node defaults

 - rpm_install_initd:
   - exec_chroot: cp /usr/local/share/doc/oar-server/examples/init.d/oar-server /etc/rc.d/init.d/
   - exec_chroot: cp /usr/local/share/doc/oar-node/examples/init.d/oar-node /etc/rc.d/init.d/
   - exec_chroot: cp /usr/local/share/doc/oar-server/examples/default/oar-server /etc/sysconfig/
   - exec_chroot: cp /usr/local/share/doc/oar-node/examples/default/oar-node /etc/sysconfig/
   - exec_chroot: chkconfig --add oar-server
   - exec_chroot: chkconfig --add oar-node





