<!DOCTYPE html>
<html>
  <head>
    <title>Drawgantt Multisite NG</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<style>
body {
margin: 0px;
}
.gantt {
left: 0px;
z-index: 0;
}
.spacer {
width: 100%;
}
#spacer_top {
height: 40px;
}
#spacer_bottom {
height: 35px;
}
.ruler {
position: fixed;
left: 0px;
z-index: 1;
}
#ruler_top {
top: 5px;
}
#ruler_bottom {
bottom: 5px;
}
#infobox {
position: absolute;
top: 0px;
left: 0px;
width: auto;
height: auto;
z-index: 2;
background: white;
border: 1px solid;
border-radius: 8px;
font-size: 60%;
}
#debug {
position: fixed;
background: white;
top: 0px;
right: 0px;
z-index: 3;
font-size: 70%;
}
</style>
<script>
var infobox;
var debug;
// push the reference of the SVG object to the SVG doc
// object reference is used to get the SVG doc coordinates in the HTML document (see getBoundingClientRect) in the SVG js
// (the other option using svg.screenY - html.mozInnerScreenY is not portable)
function set_object_ref(id) {
  var obj = document.getElementById(id);
  var svg = obj.contentDocument;
  svg.object_ref = obj;
}
function mouseMove(event) {
  infoboxMove(event.clientX,event.clientY,"html");
}
function infoboxDisplay(array) {
  if (infobox == null) {
    infobox = document.getElementById("infobox");
  }
  for (i in array) {
    infobox.appendChild(document.createTextNode(array[i]));
    infobox.appendChild(document.createElement('br'));
  }
  infobox.style.visibility = "visible"; 
}
function infoboxHide() {
  if (infobox == null) {
    infobox = document.getElementById("infobox");
  }
  while (infobox.hasChildNodes()) {
    infobox.removeChild(infobox.lastChild);
  }
 infobox.style.visibility = "hidden"; 
}
function infoboxMove(x,y,str) {
  if (infobox == null) {
    infobox = document.getElementById("infobox");
  }
  infobox.style.left = Math.min((x + 15 + window.scrollX), (window.scrollX + window.innerWidth - infobox.clientWidth)) + "px";
  infobox.style.top = Math.min((y + 15 + window.scrollY), (window.scrollY + window.innerHeight - infobox.clientHeight)) + "px";
  if (debug == null) {
    var debug = document.getElementById("debug");
  }
  debug.innerHTML = "position: " + x + "," + y + "(" + str + ")";
}
function addGantt(id,url) {
  var obj = document.createElement('object');
  obj.id = id;
  obj.classList.add("gantt");
  obj.type = "image/svg+xml"
  obj.data = url;
  obj.innerHTML = url;
  obj.addEventListener("load", function() { set_object_ref(id); }, false);
  document.getElementById("gantts").appendChild(obj);
}
function addRuler(id,url) {
  var obj = document.createElement('object');
  obj.id = id;
  obj.classList.add("ruler");
  obj.type = "image/svg+xml"
  obj.data = url;
  obj.innerHTML = url;
  document.getElementById("gantts").appendChild(obj);
}
function init() {
  var url_base = "https://intranet.grid5000.fr/oar/";
  var url_ruler = "/drawgantt-svg/test/drawgantt-svg.php?width=" + (window.innerWidth - 50) + "&resource_base=host&display=mobile_ruler_only";
  var url_gantt = "/drawgantt-svg/test/drawgantt-svg.php?width=" + (window.innerWidth - 50) + "&resource_base=host&display=no_rulers&filter=cluster=";
  addRuler("ruler_top", url_base + "Rennes" + url_ruler);
  addGantt("gantt1", url_base + "Rennes" + url_gantt + "'parasilo'");
  addGantt("gantt2", url_base + "Rennes" + url_gantt + "'paravance'");
  addGantt("gantt3", url_base + "Nancy" + url_gantt + "'graphite'");
  addGantt("gantt4", url_base + "Grenoble" + url_gantt + "'adonis'");
  addGantt("gantt5", url_base + "Lyon" + url_gantt + "'hercule'");
  addRuler("ruler_bottom", url_base + "Rennes" + url_ruler);
}
</script>
  </head>
<body onmousemove="mouseMove(event)" onload="init()">
<div id="infobox"></div>
<div id="debug"></div>
<div id="spacer_top" class="spacer"></div>
<div id="gantts"> </div>
<div id="spacer_bottom" class="spacer"></div>
</body>
</html>
